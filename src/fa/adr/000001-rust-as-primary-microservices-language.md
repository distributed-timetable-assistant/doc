# ۳. انتخاب راست (Rust) به عنوان زبان اصلی برای میکروسرویس‌ها

تاریخ: 2025-12-19

## وضعیت
پذیرفته شده

## زمینه
DiTA یک پلتفرم توزیع‌شده و متمرکز بر حل‌کننده (solver-centric) است که بارهای کاری سنگین محاسباتی زمان‌بندی و بهینه‌سازی را اجرا می‌کند.
سیستم از چندین میکروسرویس مستقل تشکیل شده است که تحت همزمانی بالا، محدودیت‌های شدید تأخیر و محیط‌های زیرساختی حساس به هزینه (استقرارهای مبتنی بر کوبرنتیز) عمل می‌کنند.

منطق دامنه پلتفرم ذاتاً پیچیده، دارای وضعیت (stateful) و بسیار حساس به مسائل صحت عملکرد مانند شرایط رقابت (race conditions)، خرابی حافظه و رفتارهای غیر قطعی در زمان اجرا است.
از آنجایی که انتظار می‌رود پلتفرم به صورت افقی مقیاس‌پذیر باشد و به طور مداوم در محیط عملیاتی کار کند، انتخاب زبان پیاده‌سازی تأثیر مستقیمی بر قابلیت اطمینان سیستم، هزینه‌های عملیاتی و قابلیت نگهداری طولانی‌مدت دارد.

## تصمیم
Rust به عنوان زبان اصلی پیاده‌سازی برای تمام میکروسرویس‌های هسته‌ای در پلتفرم DiTA انتخاب شده است.

این تصمیم شامل موارد زیر می‌شود:
- سرویس‌های حل‌کننده (Solver services)
- سرویس‌های زمان‌بندی و ارکستراسیون
- دامنه هسته‌ای و میکروسرویس‌های مرتبط با زیرساخت

زبان Rust به عنوان زبان پیش‌فرض و ترجیحی در نظر گرفته می‌شود، مگر اینکه یک استثنای شفاف و مستند از طریق یک ADR جداگانه تأیید شود.

## پیامدها

### مثبت
- عملکرد نزدیک به C/C++ با ویژگی‌های اجرایی قابل پیش‌بینی، مناسب برای بارهای کاری سنگین حل‌کننده.
- استفاده بهینه از CPU و حافظه، که تراکم سرویس بالاتر و هزینه‌های زیرساختی کمتر را ممکن می‌سازد.
- تضمین‌های قوی زمان کامپایل برای ایمنی حافظه و همزمانی، که ریسک‌های محیط عملیاتی را به طور قابل توجهی کاهش می‌دهد.
- بهبود صحت و شفافیت در مدل‌سازی منطق پیچیده دامنه.
- دیسیپلین مهندسی کلی بالاتر و کیفیت کدبیس در طولانی‌مدت.

### منفی / ریسک‌ها
- منحنی یادگیری تندتر برای مشارکت‌کنندگان جدید.
- نمونه‌سازی اولیه کندتر در مقایسه با زبان‌های سطح بالاتر یا مدیریت شده.
- استخر استخدام کوچک‌تر در مقایسه با اکوسیستم‌های رایج‌تر.

### راهکارها (Mitigations)
- دستورالعمل‌های مهندسی شفاف و مستندات داخلی.
- کتابخانه‌های مشترک، قالب‌ها و پیاده‌سازی‌های مرجع برای الگوهای رایج سرویس.
- مواد آموزشی (Onboarding) متمرکز بر الگوهای Rust مرتبط با معماری DiTA.

